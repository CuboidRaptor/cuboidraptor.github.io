!function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/",i(i.s=10)}([function(t,e){t.exports=function(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function i(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}t.exports=function(t,e,s){return e&&i(t.prototype,e),s&&i(t,s),t}},function(t,e,i){var s=i(7),r=i(8);t.exports=function(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?r(t):e}},function(t,e){function i(e){return t.exports=i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},i(e)}t.exports=i},function(t,e,i){var s=i(9);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}},function(t,e,i){var s;!function(){"use strict";var r=.5*(Math.sqrt(3)-1),n=(3-Math.sqrt(3))/6,o=1/6,a=(Math.sqrt(5)-1)/4,h=(5-Math.sqrt(5))/20;function l(t){var e;e="function"==typeof t?t:t?function(){var t=0,e=0,i=0,s=1,r=c();t=r(" "),e=r(" "),i=r(" ");for(var n=0;n<arguments.length;n++)(t-=r(arguments[n]))<0&&(t+=1),(e-=r(arguments[n]))<0&&(e+=1),(i-=r(arguments[n]))<0&&(i+=1);return r=null,function(){var r=2091639*t+2.3283064365386963e-10*s;return t=e,e=i,i=r-(s=0|r)}}(t):Math.random,this.p=u(e),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(var i=0;i<512;i++)this.perm[i]=this.p[255&i],this.permMod12[i]=this.perm[i]%12}function u(t){var e,i=new Uint8Array(256);for(e=0;e<256;e++)i[e]=e;for(e=0;e<255;e++){var s=e+~~(t()*(256-e)),r=i[e];i[e]=i[s],i[s]=r}return i}function c(){var t=4022871197;return function(e){e=e.toString();for(var i=0;i<e.length;i++){var s=.02519603282416938*(t+=e.charCodeAt(i));s-=t=s>>>0,t=(s*=t)>>>0,t+=4294967296*(s-=t)}return 2.3283064365386963e-10*(t>>>0)}}l.prototype={grad3:new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),grad4:new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]),noise2D:function(t,e){var i,s,o=this.permMod12,a=this.perm,h=this.grad3,l=0,u=0,c=0,_=(t+e)*r,f=Math.floor(t+_),d=Math.floor(e+_),v=(f+d)*n,p=t-(f-v),y=e-(d-v);p>y?(i=1,s=0):(i=0,s=1);var m=p-i+n,b=y-s+n,g=p-1+2*n,x=y-1+2*n,w=255&f,S=255&d,z=.5-p*p-y*y;if(z>=0){var M=3*o[w+a[S]];l=(z*=z)*z*(h[M]*p+h[M+1]*y)}var I=.5-m*m-b*b;if(I>=0){var k=3*o[w+i+a[S+s]];u=(I*=I)*I*(h[k]*m+h[k+1]*b)}var O=.5-g*g-x*x;if(O>=0){var A=3*o[w+1+a[S+1]];c=(O*=O)*O*(h[A]*g+h[A+1]*x)}return 70*(l+u+c)},noise3D:function(t,e,i){var s,r,n,a,h,l,u,c,_,f,d=this.permMod12,v=this.perm,p=this.grad3,y=(t+e+i)*(1/3),m=Math.floor(t+y),b=Math.floor(e+y),g=Math.floor(i+y),x=(m+b+g)*o,w=t-(m-x),S=e-(b-x),z=i-(g-x);w>=S?S>=z?(h=1,l=0,u=0,c=1,_=1,f=0):w>=z?(h=1,l=0,u=0,c=1,_=0,f=1):(h=0,l=0,u=1,c=1,_=0,f=1):S<z?(h=0,l=0,u=1,c=0,_=1,f=1):w<z?(h=0,l=1,u=0,c=0,_=1,f=1):(h=0,l=1,u=0,c=1,_=1,f=0);var M=w-h+o,I=S-l+o,k=z-u+o,O=w-c+2*o,A=S-_+2*o,C=z-f+2*o,V=w-1+.5,N=S-1+.5,G=z-1+.5,j=255&m,U=255&b,P=255&g,F=.6-w*w-S*S-z*z;if(F<0)s=0;else{var T=3*d[j+v[U+v[P]]];s=(F*=F)*F*(p[T]*w+p[T+1]*S+p[T+2]*z)}var D=.6-M*M-I*I-k*k;if(D<0)r=0;else{var q=3*d[j+h+v[U+l+v[P+u]]];r=(D*=D)*D*(p[q]*M+p[q+1]*I+p[q+2]*k)}var B=.6-O*O-A*A-C*C;if(B<0)n=0;else{var R=3*d[j+c+v[U+_+v[P+f]]];n=(B*=B)*B*(p[R]*O+p[R+1]*A+p[R+2]*C)}var L=.6-V*V-N*N-G*G;if(L<0)a=0;else{var E=3*d[j+1+v[U+1+v[P+1]]];a=(L*=L)*L*(p[E]*V+p[E+1]*N+p[E+2]*G)}return 32*(s+r+n+a)},noise4D:function(t,e,i,s){var r,n,o,l,u,c,_,f,d,v,p,y,m,b,g,x,w,S=this.perm,z=this.grad4,M=(t+e+i+s)*a,I=Math.floor(t+M),k=Math.floor(e+M),O=Math.floor(i+M),A=Math.floor(s+M),C=(I+k+O+A)*h,V=t-(I-C),N=e-(k-C),G=i-(O-C),j=s-(A-C),U=0,P=0,F=0,T=0;V>N?U++:P++,V>G?U++:F++,V>j?U++:T++,N>G?P++:F++,N>j?P++:T++,G>j?F++:T++;var D=V-(c=U>=3?1:0)+h,q=N-(_=P>=3?1:0)+h,B=G-(f=F>=3?1:0)+h,R=j-(d=T>=3?1:0)+h,L=V-(v=U>=2?1:0)+2*h,E=N-(p=P>=2?1:0)+2*h,H=G-(y=F>=2?1:0)+2*h,J=j-(m=T>=2?1:0)+2*h,K=V-(b=U>=1?1:0)+3*h,Q=N-(g=P>=1?1:0)+3*h,W=G-(x=F>=1?1:0)+3*h,X=j-(w=T>=1?1:0)+3*h,Y=V-1+4*h,Z=N-1+4*h,$=G-1+4*h,tt=j-1+4*h,et=255&I,it=255&k,st=255&O,rt=255&A,nt=.6-V*V-N*N-G*G-j*j;if(nt<0)r=0;else{var ot=S[et+S[it+S[st+S[rt]]]]%32*4;r=(nt*=nt)*nt*(z[ot]*V+z[ot+1]*N+z[ot+2]*G+z[ot+3]*j)}var at=.6-D*D-q*q-B*B-R*R;if(at<0)n=0;else{var ht=S[et+c+S[it+_+S[st+f+S[rt+d]]]]%32*4;n=(at*=at)*at*(z[ht]*D+z[ht+1]*q+z[ht+2]*B+z[ht+3]*R)}var lt=.6-L*L-E*E-H*H-J*J;if(lt<0)o=0;else{var ut=S[et+v+S[it+p+S[st+y+S[rt+m]]]]%32*4;o=(lt*=lt)*lt*(z[ut]*L+z[ut+1]*E+z[ut+2]*H+z[ut+3]*J)}var ct=.6-K*K-Q*Q-W*W-X*X;if(ct<0)l=0;else{var _t=S[et+b+S[it+g+S[st+x+S[rt+w]]]]%32*4;l=(ct*=ct)*ct*(z[_t]*K+z[_t+1]*Q+z[_t+2]*W+z[_t+3]*X)}var ft=.6-Y*Y-Z*Z-$*$-tt*tt;if(ft<0)u=0;else{var dt=S[et+1+S[it+1+S[st+1+S[rt+1]]]]%32*4;u=(ft*=ft)*ft*(z[dt]*Y+z[dt+1]*Z+z[dt+2]*$+z[dt+3]*tt)}return 27*(r+n+o+l+u)}},l._buildPermutationTable=u,void 0===(s=function(){return l}.call(e,i,e,t))||(t.exports=s),e.SimplexNoise=l,t.exports=l}()},function(t,e){function i(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=i=function(t){return typeof t}:t.exports=i=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(e)}t.exports=i},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e){function i(e,s){return t.exports=i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},i(e,s)}t.exports=i},function(t,e,i){"use strict";i.r(e);var s,r=i(1),n=i.n(r),o=i(2),a=i.n(o),h=i(0),l=i.n(h);!function(t){t.Simple="Simple",t.Ridged="Ridged"}(s||(s={}));var u=s,c=i(3),_=i.n(c),f=i(4),d=i.n(f),v=i(5),p=i.n(v),y=i(6),m=i.n(y),b=function t(e,i){n()(this,t),this._planetSeed=e,this._noiseConfig=i,l()(this,"_simplex",void 0),this._simplex=new m.a(this._planetSeed)},g=function(t){function e(){return n()(this,e),_()(this,d()(e).apply(this,arguments))}return p()(e,t),a()(e,[{key:"evaluateUnscaled",value:function(t,e,i){for(var s=this._noiseConfig.baseLacunarity,r=1,n=0,o=0,a=0;a<this._noiseConfig.octaves;a++){var h=r*(this._simplex.noise3D(t*s,e*s,i*s)+1)/2;o+=r,s*=this._noiseConfig.lacunarity,r*=this._noiseConfig.persistence,n+=h}return n/o}},{key:"evaluate",value:function(t,e,i){return(this.evaluateUnscaled(t,e,i)-this._noiseConfig.minHeight)*this._noiseConfig.strength}}]),e}(b),x=function(t){function e(){return n()(this,e),_()(this,d()(e).apply(this,arguments))}return p()(e,t),a()(e,[{key:"ridgedNoise",value:function(t,e,i){return 2*(.5-Math.abs(this._simplex.noise3D(t,e,i)/2))}},{key:"evaluateUnscaled",value:function(t,e,i){for(var s=this._noiseConfig.baseLacunarity,r=1,n=0,o=1,a=0,h=0;h<this._noiseConfig.octaves;h++){var l=o*r*this.ridgedNoise(t*s,e*s,i*s);a+=o*r,l=Math.pow(l,2),o+=0==h?-1+l:l,s*=this._noiseConfig.lacunarity,r*=this._noiseConfig.persistence,n+=l}return n/a}},{key:"evaluate",value:function(t,e,i){return(this.evaluateUnscaled(t,e,i)-this._noiseConfig.minHeight)*this._noiseConfig.strength}}]),e}(b),w=function(){function t(){n()(this,t)}return a()(t,null,[{key:"noiseGeneratorFromConfig",value:function(t,e){switch(t.type){case u.Ridged:return new x(e,t);case u.Simple:default:return new g(e,t)}}}]),t}(),S=function(){function t(e,i){n()(this,t),this._planetSeed=e,this._noiseSettings=i,l()(this,"_noiseGenerators",void 0),this._noiseGenerators=[];for(var s=0;s<this._noiseSettings.length;s++)this._noiseGenerators.push(w.noiseGeneratorFromConfig(this._noiseSettings[s],this._planetSeed))}return a()(t,[{key:"evaluate",value:function(t,e,i){var s=0,r=0;this._noiseSettings.length>0&&(r=this._noiseGenerators[0].evaluate(t,e,i),this._noiseSettings[0].enabled&&(s=r));for(var n=1;n<this._noiseSettings.length;n++)if(this._noiseSettings[n].enabled&&!(this._noiseSettings[n].useFirstLayerAsMask&&r<=0)){var o=this._noiseSettings[n].useFirstLayerAsMask?r:1;s+=this._noiseGenerators[n].evaluate(t,e,i)*o}return s}}]),t}(),z=function(){function t(e,i,s){n()(this,t),this.x=e,this.y=i,this.z=s}return a()(t,[{key:"clone",value:function(){return new t(this.x,this.y,this.z)}},{key:"cross",value:function(e){return new t(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}},{key:"subtract",value:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"normalize",value:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)||1;this.x/=t,this.y/=t,this.z/=t}}]),t}(),M=function(){function t(e,i,s,r,o,a){n()(this,t),this._localUp=e,this._resolution=i,this._radius=s,this._hasOcean=r,this._terrainGenerator=o,this._precipitationGenerator=a,l()(this,"_axisA",void 0),l()(this,"_axisB",void 0),l()(this,"_size",void 0),l()(this,"_vertices",void 0),l()(this,"_indices",void 0),l()(this,"_elevations",void 0),l()(this,"_precipitations",void 0),l()(this,"_polarVals",void 0),l()(this,"_normals",void 0),l()(this,"_borderVertices",void 0),l()(this,"_borderIndices",void 0),l()(this,"_indicesIdx",void 0),l()(this,"_borderIndicesIdx",void 0),this._axisA=new z(this._localUp.y,this._localUp.z,this._localUp.x),this._axisB=this._axisA.clone().cross(this._localUp),this._size=this._resolution*this._resolution,this._vertices=new Float32Array(3*this._size),this._indices=new Uint16Array((this._resolution-1)*(this._resolution-1)*2*3),this._elevations=new Float32Array(this._size),this._precipitations=new Float32Array(this._size),this._polarVals=new Float32Array(this._size),this._normals=new Float32Array(3*this._size),this._indicesIdx=0,this._borderIndicesIdx=0,this._borderVertices=new Float32Array(3*(4*(this._resolution+1)-4)),this._borderIndices=new Float32Array(6*(4*this._resolution-4))}return a()(t,[{key:"getPoint",value:function(t,e){var i=0===t||0===e||t===this._resolution+1||e===this._resolution+1;t===this._resolution+1&&--t,t>0&&--t,e===this._resolution+1&&--e,e>0&&--e;var s=t/(this._resolution-1),r=e/(this._resolution-1),n=this._localUp.clone();return n.add(this._axisA.clone().multiplyScalar(2*(s-.5))),n.add(this._axisB.clone().multiplyScalar(2*(r-.5))),i&&n.add(this._localUp.clone().multiplyScalar(-2/(this._resolution-1))),n.normalize(),n}},{key:"isCorner",value:function(t,e){return!(0!==t&&t!==this._resolution+1||0!==e&&e!==this._resolution+1)}},{key:"addNormalTriangle",value:function(t,e,i){this._indices[this._indicesIdx++]=t,this._indices[this._indicesIdx++]=e,this._indices[this._indicesIdx++]=i}},{key:"addBorderTriangle",value:function(t,e,i){this._borderIndices[this._borderIndicesIdx++]=t,this._borderIndices[this._borderIndicesIdx++]=e,this._borderIndices[this._borderIndicesIdx++]=i}},{key:"GenerateGeometryData",value:function(){for(var t=0,e=-1,i=[],s=0;s<this._resolution+2;s++)for(var r=0;r<this._resolution+2;r++)this.isCorner(r,s)?i.push(NaN):0===r||0===s||r===this._resolution+1||s===this._resolution+1?i.push(e--):i.push(t++);for(var n=0;n<this._resolution+2;n++)for(var o=0;o<this._resolution+2;o++)if(!this.isCorner(o,n)){var a=i[o+n*(this._resolution+2)],h=this.getPoint(o,n),l=this._terrainGenerator.evaluate(h.x,h.y,h.z);if(a>=0&&(this._precipitations[a]=this._precipitationGenerator.evaluate(h.x,h.y,h.z),this._polarVals[a]=Math.abs(h.y)+this._precipitations[a]/2-.12,this._elevations[a]=l),this._hasOcean&&(l=Math.max(0,l)),h.multiplyScalar(this._radius+l),a>=0)this._vertices[3*a]=h.x,this._vertices[3*a+1]=h.y,this._vertices[3*a+2]=h.z;else{var u=-a-1;this._borderVertices[3*u]=h.x,this._borderVertices[3*u+1]=h.y,this._borderVertices[3*u+2]=h.z}if(o<this._resolution+1&&n<this._resolution+1){var c=a,_=i[o+1+n*(this._resolution+2)],f=i[o+(n+1)*(this._resolution+2)],d=i[o+1+(n+1)*(this._resolution+2)];if(isNaN(c)||isNaN(_)||isNaN(f)||isNaN(d))continue;c<0||_<0||f<0||d<0?(this.addBorderTriangle(c,f,_),this.addBorderTriangle(_,f,d)):(this.addNormalTriangle(c,f,d),this.addNormalTriangle(c,d,_))}}return this.calculateNormals(),{vertices:this._vertices,indices:this._indices,elevations:this._elevations,precipitations:this._precipitations,polarVals:this._polarVals,normals:this._normals}}},{key:"calculateNormals",value:function(){for(var t=0;t<this._indices.length/3;t++){var e=this._indices[3*t],i=this._indices[3*t+1],s=this._indices[3*t+2],r=new z(this._vertices[3*e],this._vertices[3*e+1],this._vertices[3*e+2]),n=new z(this._vertices[3*i],this._vertices[3*i+1],this._vertices[3*i+2]),o=new z(this._vertices[3*s],this._vertices[3*s+1],this._vertices[3*s+2]),a=n.clone().subtract(r).cross(o.clone().subtract(r));this._normals[3*e]+=a.x,this._normals[3*e+1]+=a.y,this._normals[3*e+2]+=a.z,this._normals[3*i]+=a.x,this._normals[3*i+1]+=a.y,this._normals[3*i+2]+=a.z,this._normals[3*s]+=a.x,this._normals[3*s+1]+=a.y,this._normals[3*s+2]+=a.z}for(var h=0;h<this._borderIndices.length/3;h++){var l=this._borderIndices[3*h],u=this._borderIndices[3*h+1],c=this._borderIndices[3*h+2],_=l<0?new z(this._borderVertices[3*(-l-1)],this._borderVertices[3*(-l-1)+1],this._borderVertices[3*(-l-1)+2]):new z(this._vertices[3*l],this._vertices[3*l+1],this._vertices[3*l+2]),f=u<0?new z(this._borderVertices[3*(-u-1)],this._borderVertices[3*(-u-1)+1],this._borderVertices[3*(-u-1)+2]):new z(this._vertices[3*u],this._vertices[3*u+1],this._vertices[3*u+2]),d=c<0?new z(this._borderVertices[3*(-c-1)],this._borderVertices[3*(-c-1)+1],this._borderVertices[3*(-c-1)+2]):new z(this._vertices[3*c],this._vertices[3*c+1],this._vertices[3*c+2]),v=f.clone().subtract(_).cross(d.clone().subtract(_));l>=0&&(this._normals[3*l]+=v.x,this._normals[3*l+1]+=v.y,this._normals[3*l+2]+=v.z),u>=0&&(this._normals[3*u]+=v.x,this._normals[3*u+1]+=v.y,this._normals[3*u+2]+=v.z),c>=0&&(this._normals[3*c]+=v.x,this._normals[3*c+1]+=v.y,this._normals[3*c+2]+=v.z)}for(var p=0;p<this._normals.length/3;p++){var y=new z(this._normals[3*p],this._normals[3*p+1],this._normals[3*p+2]);y.normalize(),this._normals[3*p]=y.x,this._normals[3*p+1]=y.y,this._normals[3*p+2]=y.z}}}]),t}();onmessage=function(t){switch(t.data.event){case"request_planet":!function(t){const e=[],i=new S(t.planetSeed,t.noiseSettings),s=new g(t.planetSeed+"_precipitation",t.precipitationNoiseSettings),r=[];for(let n=0;n<t.directions.length;n++){const o=new M(new z(t.directions[n].x,t.directions[n].y,t.directions[n].z),t.planetResolution,t.planetRadius,t.hasOcean,i,s).GenerateGeometryData();e.push({direction:t.directions[n],planetGeometryData:o}),r.push(o.vertices.buffer),r.push(o.indices.buffer),r.push(o.elevations.buffer),r.push(o.precipitations.buffer),r.push(o.polarVals.buffer),r.push(o.normals.buffer)}postMessage({event:"planet_data",data:e},r)}(t.data)}}}]);